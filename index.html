<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matxambrats</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Initial Language Selection Screen -->
    <div id="language-selection-screen" style="display: none;">
        <h1>Matxambrats</h1>
        <p class="tagline">v0.5</p>
        <h2 data-ca="Selecciona idioma" data-en="Select language" data-es="Selecciona idioma">Selecciona idioma</h2>
        <div class="player-name-wrapper">
            <label for="player-name-lang" data-ca="Nom" data-en="Name" data-es="Nombre">Nom</label>
            <input id="player-name-lang" type="text" maxlength="12" placeholder="Player" />
        </div>
        <div class="language-selection-buttons">
            <button id="select-lang-ca" class="lang-select-btn">Catal√†</button>
            <button id="select-lang-en" class="lang-select-btn">English</button>
            <button id="select-lang-es" class="lang-select-btn">Castellano</button>
        </div>
    </div>

    <div id="menu">
        <h1>Matxambrats</h1>
        <p class="tagline">v0.5</p>
        <button id="new-game" data-ca="Nova Partida" data-en="New Game" data-es="Nueva Partida">Nova Partida</button>
        <button id="how-to-play" data-ca="Com Jugar" data-en="How to Play" data-es="C√≥mo Jugar">Com Jugar</button>
        <button id="highscores" data-ca="Puntuacions" data-en="Highscores" data-es="Puntuaciones">Puntuacions</button>
        <button id="settings" data-ca="Opcions" data-en="Settings" data-es="Opciones">Opcions</button>
        <button id="credits" data-ca="Cr√®dits" data-en="Credits" data-es="Cr√©ditos">Cr√®dits</button>
    </div>
    
    <!-- Settings Screen -->
    <div id="settings-screen" style="display: none;">
        <h1 data-ca="Opcions" data-en="Settings" data-es="Opciones">Opcions</h1>
        <div class="settings-content">
            <section class="settings-section">
                <h3 data-ca="Jugador" data-en="Player" data-es="Jugador">Jugador</h3>
                <div class="player-name-wrapper">
                    <label for="player-name-settings" data-ca="Nom" data-en="Name" data-es="Nombre">Nom</label>
                    <input id="player-name-settings" type="text" maxlength="12" placeholder="Player" />
                </div>
            </section>
            
            <section class="settings-section">
                <h3 data-ca="Idioma" data-en="Language" data-es="Idioma">Idioma</h3>
                <div class="language-selector">
                    <button id="settings-lang-ca" class="lang-btn active">Catal√†</button>
                    <button id="settings-lang-en" class="lang-btn">English</button>
                    <button id="settings-lang-es" class="lang-btn">Castellano</button>
                </div>
            </section>
            
            <section class="settings-section">
                <h3 data-ca="M√∫sica" data-en="Music" data-es="M√∫sica">M√∫sica</h3>
                <div class="music-control">
                    <input type="checkbox" id="settings-music-enabled">
                    <label for="settings-music-enabled" data-ca="M√∫sica" data-en="Music" data-es="M√∫sica">M√∫sica</label>
                </div>
                <div class="music-control">
                    <button id="settings-music-mute" data-ca="Silenciar" data-en="Mute" data-es="Silenciar">Silenciar</button>
                    <label for="settings-music-volume" data-ca="Volum" data-en="Volume" data-es="Volumen">Volum</label>
                    <input type="range" id="settings-music-volume" min="0" max="1" step="0.05" value="0.5" />
                </div>
            </section>
            
            <section class="settings-section">
                <h3 data-ca="Dades" data-en="Data" data-es="Datos">Dades</h3>
                <button id="clear-all-data" class="danger-btn" data-ca="Esborrar Totes les Dades Locals" data-en="Clear All Local Data" data-es="Borrar Todos los Datos Locales">Esborrar Totes les Dades Locals</button>
            </section>
        </div>
        <div class="settings-actions">
            <button id="back-to-menu-settings" data-ca="Tornar al Men√∫" data-en="Back to Menu" data-es="Volver al Men√∫">Tornar al Men√∫</button>
        </div>
    </div>
    <div id="game-container" style="display: none;">
        <canvas id="game-canvas"></canvas>
        <div id="game-info">
            <div class="game-stats">
                <div>
                    <h3 data-ca="Puntuaci√≥" data-en="Score" data-es="Puntuaci√≥n">Puntuaci√≥</h3>
                    <p id="score">0</p>
                </div>
                <div>
                    <h3 data-ca="Temps" data-en="Time" data-es="Tiempo">Temps</h3>
                    <p id="timer">00:00</p>
                </div>
                <div>
                    <h3 data-ca="Nivell" data-en="Level" data-es="Nivel">Nivell</h3>
                    <p id="level">1</p>
                </div>
            </div>
            <div class="game-buttons">
                <button id="pause-btn" data-ca="Pausa" data-en="Pause" data-es="Pausa" title="Pausa (Espai)">&#x23F8;</button>
                <button id="back-to-menu-game" data-ca="Men√∫" data-en="Menu" data-es="Men√∫">Men√∫</button>
            </div>
            <h3 data-ca="Seg√ºent" data-en="Next" data-es="Siguiente">Seg√ºent</h3>
            <canvas id="next-piece-canvas"></canvas>
            <div id="mobile-controls">
                <button id="left">&#x2B05;</button>
                <button id="rotate">&#x21BB;</button>
                <button id="right">&#x27A1;</button>
                <button id="down">&#x2B07;</button>
            </div>
        </div>
    </div>
    <div id="highscores-screen" style="display: none;">
        <h1 data-ca="Puntuacions Altes" data-en="High Scores" data-es="Puntuaciones Altas">Puntuacions Altes</h1>
        <ul id="highscores-list">
            <!-- Scores will be populated by script.js -->
        </ul>
        <div class="highscores-actions">
            <button id="refresh-highscores" data-ca="Refrescar" data-en="Refresh" data-es="Refrescar">Refrescar</button>
            <button id="back-to-menu" data-ca="Tornar al Men√∫" data-en="Back to Menu" data-es="Volver al Men√∫">Tornar al Men√∫</button>
        </div>
    </div>
    <div id="instructions-screen" style="display: none;">
        <h1 data-ca="Com Jugar" data-en="How to Play" data-es="C√≥mo Jugar">Com Jugar</h1>
        <div class="instructions-content">
            <section class="instruction-section">
                <h3 data-ca="Objectiu" data-en="Objective" data-es="Objetivo">Objectiu</h3>
                <p data-ca="Completa l√≠nies horitzontals col¬∑locant les peces que cauen. Quan una l√≠nia est√† completa, desapareix i guanyes punts!" data-en="Complete horizontal lines by placing the falling pieces. When a line is complete, it disappears and you earn points!" data-es="¬°Completa l√≠neas horizontales colocando las piezas que caen. Cuando una l√≠nea est√° completa, desaparece y ganas puntos!">Completa l√≠nies horitzontals col¬∑locant les peces que cauen. Quan una l√≠nia est√† completa, desapareix i guanyes punts!</p>
            </section>
            
            <section class="instruction-section">
                <h3 data-ca="Controls d'Ordinador" data-en="Desktop Controls" data-es="Controles de Ordenador">Controls d'Ordinador</h3>
                <div class="controls-grid">
                    <div class="control-item">
                        <span class="control-key">‚Üê</span>
                        <span data-ca="Moure esquerra" data-en="Move left" data-es="Mover izquierda">Moure esquerra</span>
                    </div>
                    <div class="control-item">
                        <span class="control-key">‚Üí</span>
                        <span data-ca="Moure dreta" data-en="Move right" data-es="Mover derecha">Moure dreta</span>
                    </div>
                    <div class="control-item">
                        <span class="control-key">‚Üì</span>
                        <span data-ca="Baixar r√†pid" data-en="Drop faster" data-es="Bajar r√°pido">Baixar r√†pid</span>
                    </div>
                    <div class="control-item">
                        <span class="control-key">‚Üë</span>
                        <span data-ca="Rotar pe√ßa" data-en="Rotate piece" data-es="Rotar pieza">Rotar pe√ßa</span>
                    </div>
                    <div class="control-item">
                        <span class="control-key" data-ca="Espai" data-en="Space" data-es="Espacio">Espai</span>
                        <span data-ca="Pausa" data-en="Pause" data-es="Pausa">Pausa</span>
                    </div>
                </div>
            </section>

            <section class="instruction-section">
                <h3 data-ca="Controls M√≤bils" data-en="Mobile Controls" data-es="Controles M√≥viles">Controls M√≤bils</h3>
                <p data-ca="Utilitza els botons a la pantalla:" data-en="Use the on-screen buttons:" data-es="Usa los botones en la pantalla:">Utilitza els botons a la pantalla:</p>
                <div class="mobile-controls-demo">
                    <div class="demo-button">‚¨ÖÔ∏è <span data-ca="Esquerra" data-en="Left" data-es="Izquierda">Esquerra</span></div>
                    <div class="demo-button">üîÑ <span data-ca="Rotar" data-en="Rotate" data-es="Rotar">Rotar</span></div>
                    <div class="demo-button">‚û°Ô∏è <span data-ca="Dreta" data-en="Right" data-es="Derecha">Dreta</span></div>
                    <div class="demo-button">‚¨áÔ∏è <span data-ca="Avall" data-en="Down" data-es="Abajo">Avall</span></div>
                </div>
            </section>

            <section class="instruction-section">
                <h3 data-ca="Peces del Joc" data-en="Game Pieces" data-es="Piezas del Juego">Peces del Joc</h3>
                <p data-ca="Hi ha 7 tipus diferents de peces (tetrominos):" data-en="There are 7 different types of pieces (tetrominos):" data-es="Hay 7 tipos diferentes de piezas (tetrominos):">Hi ha 7 tipus diferents de peces (tetrominos):</p>
                <div class="pieces-grid">
                    <div class="piece-demo">
                        <div class="piece-visual piece-i"></div>
                        <span>I</span>
                    </div>
                    <div class="piece-demo">
                        <div class="piece-visual piece-o"></div>
                        <span>O</span>
                    </div>
                    <div class="piece-demo">
                        <div class="piece-visual piece-t"></div>
                        <span>T</span>
                    </div>
                    <div class="piece-demo">
                        <div class="piece-visual piece-l"></div>
                        <span>L</span>
                    </div>
                    <div class="piece-demo">
                        <div class="piece-visual piece-j"></div>
                        <span>J</span>
                    </div>
                    <div class="piece-demo">
                        <div class="piece-visual piece-s"></div>
                        <span>S</span>
                    </div>
                    <div class="piece-demo">
                        <div class="piece-visual piece-z"></div>
                        <span>Z</span>
                    </div>
                </div>
            </section>

            <section class="instruction-section">
                <h3 data-ca="Sistema de Puntuaci√≥" data-en="Scoring System" data-es="Sistema de Puntuaci√≥n">Sistema de Puntuaci√≥</h3>
                <ul class="scoring-list">
                    <li><strong>1 l√≠nia:</strong> 10 <span data-ca="punts" data-en="points" data-es="puntos">punts</span></li>
                    <li><strong>2 l√≠nies:</strong> 30 <span data-ca="punts" data-en="points" data-es="puntos">punts</span></li>
                    <li><strong>3 l√≠nies:</strong> 50 <span data-ca="punts" data-en="points" data-es="puntos">punts</span></li>
                    <li><strong>4 l√≠nies (Tetris!):</strong> 80 <span data-ca="punts" data-en="points" data-es="puntos">punts</span></li>
                </ul>
                <p data-ca="El joc es fa m√©s r√†pid cada 80 punts!" data-en="The game gets faster every 80 points!" data-es="¬°El juego se vuelve m√°s r√°pido cada 80 puntos!">El joc es fa m√©s r√†pid cada 80 punts!</p>
            </section>

            <section class="instruction-section">
                <h3 data-ca="Consells" data-en="Tips" data-es="Consejos">Consells</h3>
                <ul class="tips-list">
                    <li data-ca="Intenta deixar espai per a les peces llargues (I)" data-en="Try to leave space for the long pieces (I)" data-es="Intenta dejar espacio para las piezas largas (I)">Intenta deixar espai per a les peces llargues (I)</li>
                    <li data-ca="No deixis forats entre les peces" data-en="Don't leave gaps between pieces" data-es="No dejes huecos entre las piezas">No deixis forats entre les peces</li>
                    <li data-ca="Planifica amb antelaci√≥ mirant la seg√ºent pe√ßa" data-en="Plan ahead by looking at the next piece" data-es="Planifica con anticipaci√≥n mirando la siguiente pieza">Planifica amb antelaci√≥ mirant la seg√ºent pe√ßa</li>
                    <li data-ca="Mant√©n les l√≠nies al nivell m√©s baix possible" data-en="Keep the lines as low as possible" data-es="Mant√©n las l√≠neas al nivel m√°s bajo posible">Mant√©n les l√≠nies al nivell m√©s baix possible</li>
                </ul>
            </section>
        </div>
        <div class="instructions-actions">
            <button id="back-to-menu-instructions" data-ca="Tornar al Men√∫" data-en="Back to Menu" data-es="Volver al Men√∫">Tornar al Men√∫</button>
        </div>
    </div>
    <audio id="bg-music" src="tetris.mp3" preload="auto" loop style="display:none"></audio>
</body>
</html>